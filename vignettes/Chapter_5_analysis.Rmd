---
title: "Two Way Vignette"
author: "Ryan Bushman"
date: "2023-11-20"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
vis_0.1_0.1_D <- compare_designs_U(data = N12_0.1_0.1, criteria = "D")
vis_0.1_0.1_A <- compare_designs_U(data = N12_0.1_0.1, criteria = "A")
vis_0.1_0.1_D
vis_0.1_0.1_A
```

```{r}
vis_0.1_0.5_D <- compare_designs_U(data = N12_0.1_0.5, criteria = "D")
vis_0.1_0.5_A <- compare_designs_U(data = N12_0.1_0.5, criteria = "A")
vis_0.1_0.5_D
vis_0.1_0.5_A
```


```{r}
vis_0.1_1_D <- compare_designs_U(data = N12_0.1_1, criteria = "D")
vis_0.1_1_A <- compare_designs_U(data = N12_0.1_1, criteria = "A")
vis_0.1_1_D
vis_0.1_1_A
```


```{r}
vis_0.1_2_D <- compare_designs_U(data = N12_0.1_2, criteria = "D")
vis_0.1_2_A <- compare_designs_U(data = N12_0.1_2, criteria = "A")
vis_0.1_2_D
vis_0.1_2_A
```


```{r}
vis_0.1_10_D <- compare_designs_U(data = N12_0.1_10, criteria = "D")
vis_0.1_10_A <- compare_designs_U(data = N12_0.1_10, criteria = "A")
vis_0.1_10_D
vis_0.1_10_A
```


```{r}
vis_0.5_0.1_D <- compare_designs_U(data = N12_0.5_0.1, criteria = "D")
vis_0.5_0.1_A <- compare_designs_U(data = N12_0.5_0.1, criteria = "A")
vis_0.5_0.1_D
vis_0.5_0.1_A
```


```{r}
vis_0.5_0.5_D <- compare_designs_U(data = N12_0.5_0.5, criteria = "D")
vis_0.5_0.5_A <- compare_designs_U(data = N12_0.5_0.5, criteria = "A")
vis_0.5_0.5_D
vis_0.5_0.5_A
```


```{r}
vis_0.5_1_D <- compare_designs_U(data = N12_0.5_1, criteria = "D")
vis_0.5_1_A <- compare_designs_U(data = N12_0.5_1, criteria = "A")
vis_0.5_1_D
vis_0.5_1_A
```


```{r}
vis_0.5_2_D <- compare_designs_U(data = N12_0.5_2, criteria = "D")
vis_0.5_2_A <- compare_designs_U(data = N12_0.5_2, criteria = "A")
vis_0.5_2_D
vis_0.5_2_A
```


```{r}
vis_0.5_10_D <- compare_designs_U(data = N12_0.5_10, criteria = "D")
vis_0.5_10_A <- compare_designs_U(data = N12_0.5_10, criteria = "A")
vis_0.5_10_D
vis_0.5_10_A
```


```{r}
vis_1_0.1_D <- compare_designs_U(data = N12_1_0.1, criteria = "D")
vis_1_0.1_A <- compare_designs_U(data = N12_1_0.1, criteria = "A")
vis_1_0.1_D
vis_1_0.1_A
```

```{r}
vis_1_0.5_D <- compare_designs_U(data = N12_1_0.5, criteria = "D")
vis_1_0.5_A <- compare_designs_U(data = N12_1_0.5, criteria = "A")
vis_1_0.5_D
vis_1_0.5_A
```


```{r}
vis_1_1_D <- compare_designs_U(data = N12_1_1, criteria = "D")
vis_1_1_A <- compare_designs_U(data = N12_1_1, criteria = "A")
vis_1_1_D
vis_1_1_A
```


```{r}
vis_1_2_D <- compare_designs_U(data = N12_1_2, criteria = "D")
vis_1_2_A <- compare_designs_U(data = N12_1_2, criteria = "A")
vis_1_2_D
vis_1_2_A
```


```{r}
vis_1_10_D <- compare_designs_U(data = N12_1_10, criteria = "D")
vis_1_10_A <- compare_designs_U(data = N12_1_10, criteria = "A")
vis_1_10_D
vis_1_10_A
```


```{r}
vis_2_0.1_D <- compare_designs_U(data = N12_2_0.1, criteria = "D")
vis_2_0.1_A <- compare_designs_U(data = N12_2_0.1, criteria = "A")
vis_2_0.1_D
vis_2_0.1_A
```

```{r}
vis_2_0.5_D <- compare_designs_U(data = N12_2_0.5, criteria = "D")
vis_2_0.5_A <- compare_designs_U(data = N12_2_0.5, criteria = "A")
vis_2_0.5_D
vis_2_0.5_A
```


```{r}
vis_2_1_D <- compare_designs_U(data = N12_2_1, criteria = "D")
vis_2_1_A <- compare_designs_U(data = N12_2_1, criteria = "A")
vis_2_1_D
vis_2_1_A
```


```{r}
vis_2_2_D <- compare_designs_U(data = N12_2_2, criteria = "D")
vis_2_2_A <- compare_designs_U(data = N12_2_2, criteria = "A")
vis_2_2_D
vis_2_2_A
```


```{r}
vis_2_10_D <- compare_designs_U(data = N12_2_10, criteria = "D")
vis_2_10_A <- compare_designs_U(data = N12_2_10, criteria = "A")
vis_2_10_D
vis_2_10_A
```


```{r}
vis_10_0.1_D <- compare_designs_U(data = N12_10_0.1, criteria = "D")
vis_10_0.1_A <- compare_designs_U(data = N12_10_0.1, criteria = "A")
vis_10_0.1_D
vis_10_0.1_A
```

```{r}
vis_10_0.5_D <- compare_designs_U(data = N12_10_0.5, criteria = "D")
vis_10_0.5_A <- compare_designs_U(data = N12_10_0.5, criteria = "A")
vis_10_0.5_D
vis_10_0.5_A
```


```{r}
vis_10_1_D <- compare_designs_U(data = N12_10_1, criteria = "D")
vis_10_1_A <- compare_designs_U(data = N12_10_1, criteria = "A")
vis_10_1_D
vis_10_1_A
```


```{r}
vis_10_2_D <- compare_designs_U(data = N12_10_2, criteria = "D")
vis_10_2_A <- compare_designs_U(data = N12_10_2, criteria = "A")
vis_10_2_D
vis_10_2_A
```


```{r}
vis_10_10_D <- compare_designs_U(data = N12_10_10, criteria = "D")
vis_10_10_A <- compare_designs_U(data = N12_10_10, criteria = "A")
vis_10_10_D
vis_10_10_A
```

N = 24 ANALYSIS

```{r}
vis_0.1_0.1_D_24 <- compare_designs_U(data = N24_0.1_0.1, criteria = "D")
vis_0.1_0.1_A_24 <- compare_designs_U(data = N24_0.1_0.1, criteria = "A")
vis_0.1_0.1_D_24
vis_0.1_0.1_A_24
```

```{r}
vis_0.1_0.5_D_24 <- compare_designs_U(data = N24_0.1_0.5, criteria = "D")
vis_0.1_0.5_A_24 <- compare_designs_U(data = N24_0.1_0.5, criteria = "A")
vis_0.1_0.5_D_24
vis_0.1_0.5_A_24
```


```{r}
vis_0.1_1_D_24 <- compare_designs_U(data = N24_0.1_1, criteria = "D")
vis_0.1_1_A_24 <- compare_designs_U(data = N24_0.1_1, criteria = "A")
vis_0.1_1_D_24
vis_0.1_1_A_24
```


```{r}
vis_0.1_2_D_24 <- compare_designs_U(data = N24_0.1_2, criteria = "D")
vis_0.1_2_A_24 <- compare_designs_U(data = N24_0.1_2, criteria = "A")
vis_0.1_2_D_24
vis_0.1_2_A_24
```


```{r}
vis_0.1_10_D_24 <- compare_designs_U(data = N24_0.1_10, criteria = "D")
vis_0.1_10_A_24 <- compare_designs_U(data = N24_0.1_10, criteria = "A")
vis_0.1_10_D_24
vis_0.1_10_A_24
```


```{r}
vis_0.5_0.1_D_24 <- compare_designs_U(data = N24_0.5_0.1, criteria = "D")
vis_0.5_0.1_A_24 <- compare_designs_U(data = N24_0.5_0.1, criteria = "A")
vis_0.5_0.1_D_24
vis_0.5_0.1_A_24
```


```{r}
vis_0.5_0.5_D_24 <- compare_designs_U(data = N24_0.5_0.5, criteria = "D")
vis_0.5_0.5_A_24 <- compare_designs_U(data = N24_0.5_0.5, criteria = "A")
vis_0.5_0.5_D_24
vis_0.5_0.5_A_24
```


```{r}
vis_0.5_1_D_24 <- compare_designs_U(data = N24_0.5_1, criteria = "D")
vis_0.5_1_A_24 <- compare_designs_U(data = N24_0.5_1, criteria = "A")
vis_0.5_1_D_24
vis_0.5_1_A_24
```


```{r}
vis_0.5_2_D_24 <- compare_designs_U(data = N24_0.5_2, criteria = "D")
vis_0.5_2_A_24 <- compare_designs_U(data = N24_0.5_2, criteria = "A")
vis_0.5_2_D_24
vis_0.5_2_A_24
```


```{r}
vis_0.5_10_D_24 <- compare_designs_U(data = N24_0.5_10, criteria = "D")
vis_0.5_10_A_24 <- compare_designs_U(data = N24_0.5_10, criteria = "A")
vis_0.5_10_D_24
vis_0.5_10_A_24
```


```{r}
vis_1_0.1_D_24 <- compare_designs_U(data = N24_1_0.1, criteria = "D")
vis_1_0.1_A_24 <- compare_designs_U(data = N24_1_0.1, criteria = "A")
vis_1_0.1_D_24
vis_1_0.1_A_24
```

```{r}
vis_1_0.5_D_24 <- compare_designs_U(data = N24_1_0.5, criteria = "D")
vis_1_0.5_A_24 <- compare_designs_U(data = N24_1_0.5, criteria = "A")
vis_1_0.5_D_24
vis_1_0.5_A_24
```


```{r}
vis_1_1_D_24 <- compare_designs_U(data = N24_1_1, criteria = "D")
vis_1_1_A_24 <- compare_designs_U(data = N24_1_1, criteria = "A")
vis_1_1_D_24
vis_1_1_A_24
```


```{r}
vis_1_2_D_24 <- compare_designs_U(data = N24_1_2, criteria = "D")
vis_1_2_A_24 <- compare_designs_U(data = N24_1_2, criteria = "A")
vis_1_2_D_24
vis_1_2_A_24
```


```{r}
vis_1_10_D_24 <- compare_designs_U(data = N24_1_10, criteria = "D")
vis_1_10_A_24 <- compare_designs_U(data = N24_1_10, criteria = "A")
vis_1_10_D_24
vis_1_10_A_24
```


```{r}
vis_2_0.1_D_24 <- compare_designs_U(data = N24_2_0.1, criteria = "D")
vis_2_0.1_A_24 <- compare_designs_U(data = N24_2_0.1, criteria = "A")
vis_2_0.1_D_24
vis_2_0.1_A_24
```

```{r}
vis_2_0.5_D_24 <- compare_designs_U(data = N24_2_0.5, criteria = "D")
vis_2_0.5_A_24 <- compare_designs_U(data = N24_2_0.5, criteria = "A")
vis_2_0.5_D_24
vis_2_0.5_A_24
```


```{r}
vis_2_1_D_24 <- compare_designs_U(data = N24_2_1, criteria = "D")
vis_2_1_A_24 <- compare_designs_U(data = N24_2_1, criteria = "A")
vis_2_1_D_24
vis_2_1_A_24
```


```{r}
vis_2_2_D_24 <- compare_designs_U(data = N24_2_2, criteria = "D")
vis_2_2_A_24 <- compare_designs_U(data = N24_2_2, criteria = "A")
vis_2_2_D_24
vis_2_2_A_24
```


```{r}
vis_2_10_D_24 <- compare_designs_U(data = N24_2_10, criteria = "D")
vis_2_10_A_24 <- compare_designs_U(data = N24_2_10, criteria = "A")
vis_2_10_D_24
vis_2_10_A_24
```


```{r}
vis_10_0.1_D_24 <- compare_designs_U(data = N24_10_0.1, criteria = "D")
vis_10_0.1_A_24 <- compare_designs_U(data = N24_10_0.1, criteria = "A")
vis_10_0.1_D_24
vis_10_0.1_A_24
```

```{r}
vis_10_0.5_D_24 <- compare_designs_U(data = N24_10_0.5, criteria = "D")
vis_10_0.5_A_24 <- compare_designs_U(data = N24_10_0.5, criteria = "A")
vis_10_0.5_D_24
vis_10_0.5_A_24
```


```{r}
vis_10_1_D_24 <- compare_designs_U(data = N24_10_1, criteria = "D")
vis_10_1_A_24 <- compare_designs_U(data = N24_10_1, criteria = "A")
vis_10_1_D_24
vis_10_1_A_24
```


```{r}
vis_10_2_D_24 <- compare_designs_U(data = N24_10_2, criteria = "D")
vis_10_2_A_24 <- compare_designs_U(data = N24_10_2, criteria = "A")
vis_10_2_D_24
vis_10_2_A_24
```


```{r}
vis_10_10_D_24 <- compare_designs_U(data = N24_10_10, criteria = "D")
vis_10_10_A_24 <- compare_designs_U(data = N24_10_10, criteria = "A")
vis_10_10_D_24
vis_10_10_A_24
```

N = 12, s = 3 ANALYSIS

```{r}
vis_0.1_0.1_D_12_3 <- compare_designs_U(data = N12_3_0.1_0.1, criteria = "D")
vis_0.1_0.1_A_12_3 <- compare_designs_U(data = N12_3_0.1_0.1, criteria = "A")
vis_0.1_0.1_D_12_3 
vis_0.1_0.1_A_12_3
```

```{r}
vis_0.1_0.5_D_12_3 <- compare_designs_U(data = N12_3_0.1_0.5, criteria = "D")
vis_0.1_0.5_A_12_3 <- compare_designs_U(data = N12_3_0.1_0.5, criteria = "A")
vis_0.1_0.5_D_12_3
vis_0.1_0.5_A_12_3
```


```{r}
vis_0.1_1_D_12_3 <- compare_designs_U(data = N12_3_0.1_1, criteria = "D")
vis_0.1_1_A_12_3 <- compare_designs_U(data = N12_3_0.1_1, criteria = "A")
vis_0.1_1_D_12_3
vis_0.1_1_A_12_3
```


```{r}
vis_0.1_2_D_12_3 <- compare_designs_U(data = N12_3_0.1_2, criteria = "D")
vis_0.1_2_A_12_3 <- compare_designs_U(data = N12_3_0.1_2, criteria = "A")
vis_0.1_2_D_12_3
vis_0.1_2_A_12_3
```


```{r}
vis_0.1_10_D_12_3 <- compare_designs_U(data = N12_3_0.1_10, criteria = "D")
vis_0.1_10_A_12_3 <- compare_designs_U(data = N12_3_0.1_10, criteria = "A")
vis_0.1_10_D_12_3
vis_0.1_10_A_12_3
```


```{r}
vis_0.5_0.1_D_12_3 <- compare_designs_U(data = N12_3_0.5_0.1, criteria = "D")
vis_0.5_0.1_A_12_3 <- compare_designs_U(data = N12_3_0.5_0.1, criteria = "A")
vis_0.5_0.1_D_12_3
vis_0.5_0.1_A_12_3
```


```{r}
vis_0.5_0.5_D_12_3 <- compare_designs_U(data = N12_3_0.5_0.5, criteria = "D")
vis_0.5_0.5_A_12_3 <- compare_designs_U(data = N12_3_0.5_0.5, criteria = "A")
vis_0.5_0.5_D_12_3
vis_0.5_0.5_A_12_3
```


```{r}
vis_0.5_1_D_12_3 <- compare_designs_U(data = N12_3_0.5_1, criteria = "D")
vis_0.5_1_A_12_3 <- compare_designs_U(data = N12_3_0.5_1, criteria = "A")
vis_0.5_1_D_12_3
vis_0.5_1_A_12_3
```


```{r}
vis_0.5_2_D_12_3 <- compare_designs_U(data = N12_3_0.5_2, criteria = "D")
vis_0.5_2_A_12_3 <- compare_designs_U(data = N12_3_0.5_2, criteria = "A")
vis_0.5_2_D_12_3
vis_0.5_2_A_12_3
```


```{r}
vis_0.5_10_D_12_3 <- compare_designs_U(data = N12_3_0.5_10, criteria = "D")
vis_0.5_10_A_12_3 <- compare_designs_U(data = N12_3_0.5_10, criteria = "A")
vis_0.5_10_D_12_3
vis_0.5_10_A_12_3
```


```{r}
vis_1_0.1_D_12_3 <- compare_designs_U(data = N12_3_1_0.1, criteria = "D")
vis_1_0.1_A_12_3 <- compare_designs_U(data = N12_3_1_0.1, criteria = "A")
vis_1_0.1_D_12_3
vis_1_0.1_A_12_3
```

```{r}
vis_1_0.5_D_12_3 <- compare_designs_U(data = N12_3_1_0.5, criteria = "D")
vis_1_0.5_A_12_3 <- compare_designs_U(data = N12_3_1_0.5, criteria = "A")
vis_1_0.5_D_12_3
vis_1_0.5_A_12_3
```


```{r}
vis_1_1_D_12_3 <- compare_designs_U(data = N12_3_1_1, criteria = "D")
vis_1_1_A_12_3 <- compare_designs_U(data = N12_3_1_1, criteria = "A")
vis_1_1_D_12_3
vis_1_1_A_12_3
```


```{r}
vis_1_2_D_12_3 <- compare_designs_U(data = N12_3_1_2, criteria = "D")
vis_1_2_A_12_3 <- compare_designs_U(data = N12_3_1_2, criteria = "A")
vis_1_2_D_12_3
vis_1_2_A_12_3
```


```{r}
vis_1_10_D_12_3 <- compare_designs_U(data = N12_3_1_10, criteria = "D")
vis_1_10_A_12_3 <- compare_designs_U(data = N12_3_1_10, criteria = "A")
vis_1_10_D_12_3
vis_1_10_A_12_3
```


```{r}
vis_2_0.1_D_12_3 <- compare_designs_U(data = N12_3_2_0.1, criteria = "D")
vis_2_0.1_A_12_3 <- compare_designs_U(data = N12_3_2_0.1, criteria = "A")
vis_2_0.1_D_12_3
vis_2_0.1_A_12_3
```

```{r}
vis_2_0.5_D_12_3 <- compare_designs_U(data = N12_3_2_0.5, criteria = "D")
vis_2_0.5_A_12_3 <- compare_designs_U(data = N12_3_2_0.5, criteria = "A")
vis_2_0.5_D_12_3
vis_2_0.5_A_12_3
```


```{r}
vis_2_1_D_12_3 <- compare_designs_U(data = N12_3_2_1, criteria = "D")
vis_2_1_A_12_3 <- compare_designs_U(data = N12_3_2_1, criteria = "A")
vis_2_1_D_12_3
vis_2_1_A_12_3
```


```{r}
vis_2_2_D_12_3 <- compare_designs_U(data = N12_3_2_2, criteria = "D")
vis_2_2_A_12_3 <- compare_designs_U(data = N12_3_2_2, criteria = "A")
vis_2_2_D_12_3
vis_2_2_A_12_3
```


```{r}
vis_2_10_D_12_3 <- compare_designs_U(data = N12_3_2_10, criteria = "D")
vis_2_10_A_12_3 <- compare_designs_U(data = N12_3_2_10, criteria = "A")
vis_2_10_D_12_3
vis_2_10_A_12_3
```


```{r}
vis_10_0.1_D_12_3 <- compare_designs_U(data = N12_3_10_0.1, criteria = "D")
vis_10_0.1_A_12_3 <- compare_designs_U(data = N12_3_10_0.1, criteria = "A")
vis_10_0.1_D_12_3
vis_10_0.1_A_12_3
```

```{r}
vis_10_0.5_D_12_3 <- compare_designs_U(data = N12_3_10_0.5, criteria = "D")
vis_10_0.5_A_12_3 <- compare_designs_U(data = N12_3_10_0.5, criteria = "A")
vis_10_0.5_D_12_3
vis_10_0.5_A_12_3
```


```{r}
vis_10_1_D_12_3 <- compare_designs_U(data = N12_3_10_1, criteria = "D")
vis_10_1_A_12_3 <- compare_designs_U(data = N12_3_10_1, criteria = "A")
vis_10_1_D_12_3
vis_10_1_A_12_3
```


```{r}
vis_10_2_D_12_3 <- compare_designs_U(data = N12_3_10_2, criteria = "D")
vis_10_2_A_12_3 <- compare_designs_U(data = N12_3_10_2, criteria = "A")
vis_10_2_D_12_3
vis_10_2_A_12_3
```


```{r}
vis_10_10_D_12_3 <- compare_designs_U(data = N12_3_10_10, criteria = "D")
vis_10_10_A_12_3 <- compare_designs_U(data = N12_3_10_10, criteria = "A")
vis_10_10_D_12_3
vis_10_10_A_12_3
```

Optimal Designs of size N=12 from C_32

```{r}
N12_design_1 <- plot_design_2(a = 3, b_i = c(2,2,2), n_ij = c(2,2,2,2,2,2), 
                              n_i_dot = c(4, 4, 4), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = TRUE) +
  ggtitle("Design 1") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_3 <- plot_design_2(a = 4, b_i = c(2,2,2,2), n_ij = c(2,2,2,2,1,1,1,1), 
                              n_i_dot = c(4, 4, 2, 2), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 3") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_15 <- plot_design_2(a = 5, b_i = c(2,2,2,2,2), n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1), 
                              n_i_dot = c(4, 2, 2, 2, 2), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 15") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_26 <- plot_design_2(a = 6, b_i = c(2,2,1,1,1,1), n_ij = c(2, 2, 2, 2, 1, 1, 1, 1), 
                              n_i_dot = c(4, 4, 1, 1, 1, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 26") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_37 <- plot_design_2(a = 6, b_i = c(2,2,2,2,2,1), n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              n_i_dot = c(3, 2, 2, 2, 2, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 37") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_64 <- plot_design_2(a = 8, b_i = c(2,2,2,1,1,1,1,1), n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              n_i_dot = c(3, 2, 2, 1, 1, 1, 1, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 64")  +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_70 <- plot_design_2(a = 9, b_i = c(2,1,1,1,1,1,1,1,1), n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1), 
                              n_i_dot = c(4, 1, 1, 1, 1, 1, 1, 1, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 70") +
  theme(plot.title = element_text(hjust = 0.5))
N12_design_71 <- plot_design_2(a = 9, b_i = c(2,2,1,1,1,1,1,1,1), n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              n_i_dot = c(3, 2, 1, 1, 1, 1, 1, 1, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1, criteria = "D", balanced = FALSE) +
  ggtitle("Design 71") +
  theme(plot.title = element_text(hjust = 0.5))

C_32_N12_designs <- list(N12_design_1, N12_design_3, N12_design_15, N12_design_26,
                         N12_design_37, N12_design_64, N12_design_70, N12_design_71)
gridExtra::grid.arrange(grobs = C_32_N12_designs, nrow = 4, ncol = 2)

```

Optimal Designs of size N=24 from C_32

```{r}
N24_design_1 <- plot_design_2(a = 6, b_i = c(2,2,2,2,2,2), n_ij = c(2,2,2,2,2,2,2,2,2,2,2,2),
                              n_i_dot = c(4,4,4,4,4,4), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = TRUE) +
  ggtitle("Design 1") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_3 <- plot_design_2(a = 7, b_i = c(2,2,2,2,2,2,2), n_ij = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1),
                              n_i_dot = c(4, 4, 4, 4, 4, 2, 2), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 3") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_15 <- plot_design_2(a = 8, b_i = c(2,2,2,2,2,2,2,2), 
                               n_ij = c(2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 4, 4, 4, 2, 2, 2, 2), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 15") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_49 <- plot_design_2(a = 9, b_i = c(2,2,2,2,2,2,2,2,2), 
                               n_ij = c(2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 4, 4, 2, 2, 2, 2, 2, 2), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 49") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_216 <- plot_design_2(a = 11, b_i = c(2,2,2,2,2,2,2,2,2,2,2), 
                               n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 216") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_257 <- plot_design_2(a = 12, b_i = c(2,2,2,2,1,1,1,1,1,1,1,1), 
                               n_ij = c(2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 4, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1), sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 257") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_564 <- plot_design_2(a = 16, b_i = c(2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1), 
                               n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 564") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_625 <- plot_design_2(a = 18, b_i = c(2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1), 
                               n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 625") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_643 <- plot_design_2(a = 19, b_i = c(2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1), 
                               n_ij = c(2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, 
                              error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 643") +
  theme(plot.title = element_text(hjust = 0.5))
N24_design_666 <- plot_design_2(a = 21, b_i = c(2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1), 
                               n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 666") +
  theme(plot.title = element_text(hjust = 0.5))
C_32_N24_designs <- list(N24_design_1, N24_design_3, N24_design_15, N24_design_49,
                         N24_design_216, N24_design_257, N24_design_564, 
                         N24_design_625, N24_design_643, N24_design_666)
gridExtra::grid.arrange(grobs = C_32_N24_designs, ncol = 4, nrow = 3, layout_matrix= rbind(c(1,2,3), c(4,5,6), c(7,8,9), c(NA,10,NA)))
```

```{r}

N12_3_design_3 <- plot_design_2(a = 2, b_i = c(3, 1), 
                               n_ij = c(3, 3, 3, 3),
                              n_i_dot = c(9, 3), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 3") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_16 <- plot_design_2(a = 2, b_i = c(3, 3), 
                               n_ij = c(2, 2, 2, 2, 2, 2),
                              n_i_dot = c(6, 6), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 16") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_18 <- plot_design_2(a = 2, b_i = c(2, 2), 
                               n_ij = c(3, 3, 3, 3),
                              n_i_dot = c(6, 6), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 18") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_20 <- plot_design_2(a = 3, b_i = c(3, 1, 1), 
                               n_ij = c(3, 3, 3, 2, 1),
                              n_i_dot = c(9, 2, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 20") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_78 <- plot_design_2(a = 3, b_i = c(3, 3, 2), 
                               n_ij = c(2, 2, 2, 2, 1, 1, 1, 1),
                              n_i_dot = c(6, 4, 2), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 78") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_80 <- plot_design_2(a = 3, b_i = c(3, 3, 3), 
                               n_ij = c(2, 2, 2, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(6, 3, 3), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 80") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_86 <- plot_design_2(a = 3, b_i = c(3, 2, 2), 
                               n_ij = c(2, 2, 2, 2, 2, 1, 1),
                              n_i_dot = c(6, 4, 2), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 86") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_138 <- plot_design_2(a = 3, b_i = c(2, 2, 2), 
                               n_ij = c(2, 2, 2, 2, 2, 2),
                              n_i_dot = c(4, 4, 4), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 138") +
  theme(plot.title = element_text(hjust = 0.5))
N12_3_design_139 <- plot_design_2(a = 4, b_i = c(3, 1, 1, 1), 
                               n_ij = c(3, 3, 3, 1, 1, 1),
                              n_i_dot = c(9, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 139") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_195 <- plot_design_2(a = 4, b_i = c(3, 2, 1, 1), 
                               n_ij = c(2, 2, 2, 2, 2, 1, 1),
                              n_i_dot = c(6, 4, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 195") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_198 <- plot_design_2(a = 4, b_i = c(3, 2, 2, 2), 
                               n_ij = c(2, 2, 2, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(6, 2, 2, 2), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 198") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_233 <- plot_design_2(a = 4, b_i = c(3, 3, 3, 2), 
                               n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 3, 3, 2), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 233") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_333 <- plot_design_2(a = 4, b_i = c(2, 2, 2, 2), 
                               n_ij = c(2, 2, 2, 2, 1, 1, 1, 1),
                              n_i_dot = c(4, 4, 2, 2), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 333") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_574 <- plot_design_2(a = 6, b_i = c(2, 2, 1, 1, 1, 1), 
                               n_ij = c(3, 3, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(6, 2, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 574") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_690 <- plot_design_2(a = 8, b_i = c(2, 2, 2, 1, 1, 1, 1, 1), 
                               n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(3, 2, 2, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 690") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_702 <- plot_design_2(a = 9, b_i = c(2, 1, 1, 1, 1, 1, 1, 1, 1), 
                               n_ij = c(2, 2, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(4, 1, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 702") +
  theme(plot.title = element_text(hjust = 0.5))

N12_3_design_703 <- plot_design_2(a = 9, b_i = c(2, 2, 1, 1, 1, 1, 1, 1, 1), 
                               n_ij = c(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                              n_i_dot = c(3, 2, 1, 1, 1, 1, 1, 1, 1), 
                              sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) + 
  ggtitle("Design 703") +
  theme(plot.title = element_text(hjust = 0.5))

C33_N12_designs_1 <- list(N12_3_design_3, N12_3_design_16, N12_3_design_18,
                        N12_3_design_20, N12_3_design_78, N12_3_design_80,
                        N12_3_design_86, N12_3_design_138, N12_3_design_139) 
                        
C33_N12_designs_2 <- list(N12_3_design_195, N12_3_design_198, N12_3_design_233, 
                          N12_3_design_333, N12_3_design_574, N12_3_design_690,
                          N12_3_design_702, N12_3_design_703)
gridExtra::grid.arrange(grobs = C33_N12_designs_1, ncol = 3, nrow = 3)
gridExtra::grid.arrange(grobs = C33_N12_designs_2, ncol = 2, nrow = 4)


```


```{r}
walsh <- generate_two_way_designs(N = 24, s = 2, sig_a_sq = 0.164, sig_b_sq = 0.279, error_sq = 0.327)
# multiplied each VC by 100 to make non-singular
walsh[673, 1] = 24
walsh[673, 2] = "c(8, 8, 8)"
walsh[673, 3] = "c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)"
walsh[673, 4] = D_crit(general_variance_3VC(N = 24, 
                                            n_i_dot = c(8, 8, 8), 
                                            n_ij = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), 
                                            sig_a_sq = 0.164, 
                                            sig_b_sq = 0.279, 
                                            error_sq = 0.327))
walsh$Relative.D.Efficiency <- 100 * min(walsh$D_score) / walsh$D_score
walsh[673, 6] = A_crit(general_variance_3VC(N = 24, 
                                            n_i_dot = c(8, 8, 8), 
                                            n_ij = c(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), 
                                            sig_a_sq = 0.164, 
                                            sig_b_sq = 0.279, 
                                            error_sq = 0.327))
walsh$Relative.A.Efficiency <- 100 * min(walsh$A_score) / walsh$A_score

```

```{r}
rho_1 <- c(rep("0.1", 5), rep("0.5", 5), rep("1", 5), rep("2", 5), rep("10", 5))
rho_2 <- c(rep(c("0.1", "0.5", "1", "2", "10"), 5))
exp_data <- data.frame("rho_1" = rho_1, "rho_2" = rho_2)
exp_viz <- ggplot(data = exp_data, aes(x = rho_1, y = rho_2)) +
  geom_point(size = 4) +
  scale_x_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  scale_y_discrete(limits = c("0.1", "0.5", "1", "2", "10")) + 
  ggtitle("25 point Analysis of Two-Way Random Effects Model") +
  xlab(expression(paste(rho["1"]))) + 
  ylab(expression(paste(rho["2"]))) +
  theme(axis.title=element_text(size=12))

exp_viz
```

```{r}
plot_design_2(a = 5, b_i = c(2, 2, 2, 1, 1), n_ij = c(2, 2, 2, 1, 1, 1, 2, 1), n_i_dot = c(4, 3, 2, 2, 1), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1, balanced = FALSE, criteria = "D") + ggtitle("")

plot_design_2(a = 7, 
              b_i = c(3, 3, 3, 3, 3, 3, 3), 
              n_ij = c(3, 3, 3, 3, 3, 2, 3, 3, 1, 3, 2, 2, 3, 2, 1, 3, 1, 1, 2, 2, 2), 
              n_i_dot = c(9, 8, 7, 7, 6, 5, 6), 
              sig_a_sq = 1, 
              sig_b_sq = 1, 
              error_sq = 1, 
              balanced = FALSE, 
              criteria = "D")
plot_design_2(a = 6, 
              b_i = c(3, 3, 3, 2, 2, 2), 
              n_ij = c(2, 2, 1, 2, 1, 1, 1, 1, 1, 3, 3, 3, 2, 3, 1), 
              n_i_dot = c(5, 4, 3, 6, 5, 4), 
              sig_a_sq = 1, 
              sig_b_sq = 1, 
              error_sq = 1, 
              balanced = FALSE, 
              criteria = "D")
plot_design_2(a = 6, 
              b_i = c(2, 2, 2, 1, 1, 1), 
              n_ij = c(2, 2, 2, 1, 1, 1, 3, 2, 1), 
              n_i_dot = c(4, 3, 2, 3, 2, 1), 
              sig_a_sq = 1, 
              sig_b_sq = 1, 
              error_sq = 1, 
              balanced = FALSE, 
              criteria = "D")
```

```{r}
df1 <- plot_design_2(a = 4, 
                     b_i = c(2,2,2,2),  
                     n_ij = c(2,2,2,2,1,1,1,1), 
                     n_i_dot = c(4,4,2,2),
                     sig_a_sq = 0.5, 
                     sig_b_sq = 10, 
                     error_sq = 1, 
                     criteria = "D",
                     balanced = FALSE) + ggtitle("Design 3: 100% Efficient") + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "inches")) +
  annotate(geom="text", x=-1, y=0.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=1.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=2.5, label="DF = 3", color="black", size = 3.3)


    

# Design 6

df2 <- plot_design_2(a = 4, 
                     b_i = c(2,2,2,2),  
                     n_ij = c(2,2,2,1,2,1,1,1), 
                     n_i_dot = c(4,3,3,2), 
                     sig_a_sq = 0.5,
                     sig_b_sq = 10, 
                     error_sq = 1, 
                     criteria = "D", 
                     balanced = FALSE) + 
  ggtitle("Design 6: 99.95% Efficient") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "inches"))  +
  annotate(geom="text", x=-1, y=0.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=1.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=2.5, label="DF = 3", color="black", size = 3.3) 

# Design 8

df3 <- plot_design_2(a = 4, 
                     b_i = c(2,2,2,2),  
                     n_ij = c(2,1,2,1,2,1,2,1), 
                     n_i_dot = c(3,3,3,3), 
                     sig_a_sq = 0.5,
                     sig_b_sq = 10, 
                     error_sq = 1, 
                     criteria = "D", 
                     balanced = FALSE) + 
  ggtitle("Design 8: 99.90% Efficient") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "inches"))  +
  annotate(geom="text", x=-1, y=0.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=1.5, label="DF = 4", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=2.5, label="DF = 3", color="black", size = 3.3) 

dfl <- list(df1, df2, df3)
gridExtra::grid.arrange(grobs = dfl, ncol = 1)

plot_design_2(a = 3, 
              b_i = c(2, 2, 2), 
              n_ij = c(2, 2, 2, 2, 2, 2), 
              n_i_dot = c(4, 4, 4), 
              criteria = "D", 
              balanced = TRUE, 
              sig_a_sq = 0.5, 
              sig_b_sq = 10, 
              error_sq = 1) +
  ggtitle("Design 1: 91.96% Efficient") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "inches"))  +
  annotate(geom="text", x=-1, y=0.5, label="DF = 6", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=1.5, label="DF = 3", color="black", size = 3.3) +
  annotate(geom="text", x=-1, y=2.5, label="DF = 2", color="black", size = 3.3)
```

When staggered nested designs are highly efficient

N = 12, C_32

```{r}
rho_1 <- c(rep("0.1", 5), rep("0.5", 5), rep("1", 5), rep("2", 5), rep("10", 5))
rho_2 <- c(rep(c("0.1", "0.5", "1", "2", "10"), 5))
eff_1 <- c(0, 0, 0, 0, 1,
         0, 0, 0, 0, 1,
         0, 0, 0, 1, 1,
         0, 0, 0, 1, 1,
         0, 0, 0, 1, 1)
HE_data_1 <- data.frame("rho_1" = rho_1, "rho_2" = rho_2)
N12_D_C32_eff <- ggplot(data = HE_data_1, aes(x = rho_1, y = rho_2)) +
  geom_point(aes(size = 4, color = eff_1)) +
  scale_x_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  scale_y_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  ggtitle("Highly Efficient Staggered Nested Designs", 
          subtitle = expression(paste("N = 12, Class = ", C["3,2"], ", D Criteria"))) +
  xlab(expression(paste(rho["1"]))) + 
  ylab(expression(paste(rho["2"]))) +
  theme(axis.title=element_text(size=12)) + 
  scale_color_continuous(guide = 'none') + 
  scale_size(guide = "none")

rho_1 <- c(rep("0.1", 5), rep("0.5", 5), rep("1", 5), rep("2", 5), rep("10", 5))
rho_2 <- c(rep(c("0.1", "0.5", "1", "2", "10"), 5))
eff_2 <- c(0, 0, 0, 1, 0,
         0, 0, 0, 1, 0,
         0, 0, 1, 1, 0,
         0, 1, 1, 1, 0,
         0, 0, 0, 0, 0)
HE_data_2 <- data.frame("rho_1" = rho_1, "rho_2" = rho_2)
N12_A_C32_eff <- ggplot(data = HE_data_2, aes(x = rho_1, y = rho_2)) +
  geom_point(aes(size = 4, color = eff_2)) +
  scale_x_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  scale_y_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  ggtitle("Highly Efficient Staggered Nested Designs", 
          subtitle = expression(paste("N = 12, Class = ", C["3,2"], ", A Criteria"))) +
  xlab(expression(paste(rho["1"]))) + 
  ylab(expression(paste(rho["2"]))) +
  theme(axis.title=element_text(size=12)) + 
  scale_color_continuous(guide = 'none') + 
  scale_size(guide = "none")

HE_1 <- list(N12_D_C32_eff, N12_A_C32_eff)
gridExtra::grid.arrange(grobs = HE_1, ncol = 2, nrow = 1)
```

N = 24, C_32

```{r}
rho_1 <- c(rep("0.1", 5), rep("0.5", 5), rep("1", 5), rep("2", 5), rep("10", 5))
rho_2 <- c(rep(c("0.1", "0.5", "1", "2", "10"), 5))
eff_3 <- c(0, 0, 0, 0, 1,
         0, 0, 0, 0, 1,
         0, 0, 0, 0, 1,
         0, 0, 0, 0, 1,
         0, 0, 0, 0, 1)
HE_data_3 <- data.frame("rho_1" = rho_1, "rho_2" = rho_2)
N24_D_C32_eff <- ggplot(data = HE_data_3, aes(x = rho_1, y = rho_2)) +
  geom_point(aes(size = 4, color = eff_3)) +
  scale_x_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  scale_y_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  ggtitle("Highly Efficient Staggered Nested Designs", 
          subtitle = expression(paste("N = 24, Class = ", C["3,2"], ", D Criteria"))) +
  xlab(expression(paste(rho["1"]))) + 
  ylab(expression(paste(rho["2"]))) +
  theme(axis.title=element_text(size=12)) + 
  scale_color_continuous(guide = 'none') + 
  scale_size(guide = "none")

rho_1 <- c(rep("0.1", 5), rep("0.5", 5), rep("1", 5), rep("2", 5), rep("10", 5))
rho_2 <- c(rep(c("0.1", "0.5", "1", "2", "10"), 5))
eff_4 <- c(0, 0, 0, 1, 0,
         0, 0, 0, 1, 0,
         0, 0, 1, 1, 0,
         0, 1, 1, 1, 0,
         0, 0, 0, 0, 0)
HE_data_4 <- data.frame("rho_1" = rho_1, "rho_2" = rho_2)
N24_A_C32_eff <- ggplot(data = HE_data_4, aes(x = rho_1, y = rho_2)) +
  geom_point(aes(size = 4, color = eff_4)) +
  scale_x_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  scale_y_discrete(limits = c("0.1", "0.5", "1", "2", "10")) +
  ggtitle("Highly Efficient Staggered Nested Designs", 
          subtitle = expression(paste("N = 24, Class = ", C["3,2"], ", A Criteria"))) +
  xlab(expression(paste(rho["1"]))) + 
  ylab(expression(paste(rho["2"]))) +
  theme(axis.title=element_text(size=12)) + 
  scale_color_continuous(guide = 'none') + 
  scale_size(guide = "none")

HE_2 <- list(N24_D_C32_eff, N24_A_C32_eff)
gridExtra::grid.arrange(grobs = HE_2, ncol = 2, nrow = 1)
```

```{r}
plot_design_2(a = 2, b_i = c(3, 1), n_ij = c(2, 1, 1, 1),
                              n_i_dot = c(4, 1), sig_a_sq = 1, sig_b_sq = 1, error_sq = 1,
                              criteria = "D", balanced = FALSE) +
  ggtitle("Design 3") +
  theme(plot.title = element_text(hjust = 0.5))
```

